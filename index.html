<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>JavaScript Magnifier Example</title>
  
  <style>
    /* 
      Basic Reset 
    */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: sans-serif;
      padding: 20px;
      background: #f7f7f7;
    }

    h1 {
      margin-bottom: 20px;
    }

    .magnifier-container {
      position: relative; /* For lens positioning */
      max-width: 600px;   /* Restrict container width if needed */
    }

    .magnifier-container img {
      width: 100%;
      display: block;
    }

    /* 
      The lens that hovers over the image. 
      We make it a circle or square with a border and a semi-transparent background 
      so users can see where they are magnifying.
    */
    .magnifier-lens {
      position: absolute;
      border: 3px solid #333;
      border-radius: 50%;
      /* Change the lens size here (width/height) */
      width: 100px;
      height: 100px;
      /* 
        Optional background to show the lens area 
        is separate. You can also remove this for 
        a fully transparent lens. 
      */
      background: rgba(0, 0, 0, 0.1);
      cursor: none; /* We’ll hide the cursor inside the lens */
      pointer-events: none; /* So lens doesn’t interfere with mousemove */
    }

    /* 
      The magnified image container that sits above everything 
      inside the lens. We'll absolutely position a background-image 
      to create the zoom effect.
    */
    .magnifier-lens::after {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-repeat: no-repeat;
      background-position: 0 0;
      border-radius: 50%;
    }

    /* 
      Feel free to tweak transition or box-shadow for smoother style. 
    */
    .magnifier-lens {
      box-shadow: 0 0 10px rgba(0,0,0,0.3);
    }
  </style>
</head>
<body>

  <h1>JavaScript Magnifier Example</h1>

  <div class="magnifier-container">
    <!-- Replace the src with your own high-resolution image URL -->
    <img id="myImage" src="https://via.placeholder.com/1200x800.png?text=High+Res+Image" alt="Magnifiable" />
    <div class="magnifier-lens" id="myLens"></div>
  </div>

  <script>
    (function() {
      // Get references to elements
      const img = document.getElementById("myImage");
      const lens = document.getElementById("myLens");

      // Adjust zoom factor here
      const zoom = 3; 

      // When the image loads, initialize
      img.addEventListener("load", initMagnifier);

      function initMagnifier() {
        // Set lens ::after background to the image source
        lens.style.setProperty("--magnifier-image", `url(${img.src})`);

        // We also set the background on the lens pseudo-element (in code):
        // We'll do it by injecting into lens::after via style attribute.
        // A simpler approach is to set it once in your CSS, but let's do it dynamically:
        lens.style.setProperty(
          "background-image",
          `url("${img.src}")`
        );
        
        // We don't directly apply background-image to lens, but to lens::after
        // so we do it using lens.style.setProperty with the "::after" pseudo-element 
        // in a style block if needed. For simplicity here, we’ll just set background-image 
        // on the lens and then manage background-position in the script.

        // Listen for mouse events on the image container
        img.addEventListener("mousemove", moveLens);
        img.addEventListener("touchmove", moveLens);

        // Also hide lens if mouse leaves
        img.addEventListener("mouseleave", hideLens);
        img.addEventListener("touchend", hideLens);

        // Show lens if mouse enters
        img.addEventListener("mouseenter", showLens);
        img.addEventListener("touchstart", showLens);

        // Prepare the ratio between lens background-size and normal image
        // We'll calculate the ratio based on the image width & height
        const cx = (lens.offsetWidth * zoom) / lens.offsetWidth;
        const cy = (lens.offsetHeight * zoom) / lens.offsetHeight;

        // Actually set the background size
        lens.style.backgroundSize = 
          `${img.width * zoom}px ${img.height * zoom}px`;

        function moveLens(e) {
          e.preventDefault();

          // Get the position of the cursor relative to the image
          const pos = getCursorPos(e);
          
          // Calculate lens position (top-left)
          let x = pos.x - lens.offsetWidth / 2;
          let y = pos.y - lens.offsetHeight / 2;

          // Prevent lens from going outside the image
          if (x > img.width - lens.offsetWidth) {x = img.width - lens.offsetWidth;}
          if (x < 0) {x = 0;}
          if (y > img.height - lens.offsetHeight) {y = img.height - lens.offsetHeight;}
          if (y < 0) {y = 0;}

          // Position the lens
          lens.style.left = x + "px";
          lens.style.top = y + "px";

          // Move the background image inside the lens
          lens.style.backgroundPosition = 
            `-${x * zoom}px -${y * zoom}px`;
        }

        function getCursorPos(e) {
          // For simplicity, assume the bounding box from the top-left of the page
          const rect = img.getBoundingClientRect();
          let x = e.pageX - rect.left;
          let y = e.pageY - rect.top;

          // Considering any page scrolling
          x = x - window.pageXOffset;
          y = y - window.pageYOffset;
          return { x: x, y: y };
        }

        function showLens() {
          lens.style.display = "block";
        }

        function hideLens() {
          lens.style.display = "none";
        }
      }
    })();
  </script>
</body>
</html>
